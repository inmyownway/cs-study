
# 운영체제 1주차 스터디 노트


## 운영체제란?

운영체제(Operation System)란 컴퓨터 시스템의 자원들을 효율적으로 관리하며, 
사용자가 컴퓨터를 편리하고 효과적으로 사용할 수 있도록 환경을 제공하는 여러 프로그램의 모임이다.

### 운영체제의 목적
운영체제의 목적에는 처리능력 향상, 사용 가능도 향상, 신뢰도 향상, 반환 시간 단축 등이 있습니다
### 운영체제 역할

1) 사용자를 위한 역할 -> 인터페이스 제공 (GUI,CLI)
2) 하드웨어를 위한 역할 -> 운영체제의 가장 핵심적인 기능은 각종 하드웨어를 관리하는 일입니다, 운영체제는 컴퓨터 시스템 내의 자원을 효율적으로 관리하는 역할을 합니다.
  - 프로세스 관리: 음악,게임,브라우저(모두 프로세스) 동시 사용할때 , CPU는 한번에 한 프로세스만 처리하는데 동시에 하고 있다고 느끼는 이유는
    운영체제에서 적절한 방식으로 프로세스를 관해줌 -> 시분할방식,CPU 스케줄링
  - 메모리관리: 여러 프로그램을 동시에 실행시키기 때문에 메모리 관리를 하지 않으면 프로그램끼리 메모리 침범 이슈와 같은 문제들이 생기게 됩니다.  
    따라서 이러한 문제 해결을 위해 운영체제에서 메모리를 관리해줍니다.  
    또한 한정된 메모리 공간을 가지고 어떤 프로그램에 얼마만큼 메모리를 할당해줄 것인지 역시 관리합니다.  
    물리적 메모리 관리 방식 -> 고정 분할 방식, 가변 분할 방식, 가상 메모리 방식  
  - 하드웨어 관리: 운영체제는 사용자의 하드웨어에 대한 직접 접근을 막습니다.  
    예를 들어 사용자가 하드디스크의 특정 영역에 데이터를 직접 저장하려는 경우 중요한 데이터를 덮어써 버릴 위험이 있습니다.  
    운영체제는 하드웨어 관리를 직접 하여 사용자의 실수를 방지하고 고의적인 공격에 대한 방어를 합니다.  
    또한 하드 디스크의 많은 파일들을 효율적으로 저장하고 관리해주는 역할도 수행합니다.  
### 운영체제의 기능
1. 프로세서, 기억장치, 입출력장치, 파일 및 정보 등의 자원을 관리합니다.
2. 자원을 효율적으로 관리하기 위해 자원의 스케줄링 기능을 제공합니다.
3. 사용자와 시스템간의 편리한 인터페이스를 제공합니다.
4. 시스템의 각종 하드웨어와 네트워크를 관리, 제어합니다.
5. 데이터를 관리하고, 데이터 및 자원의 공유 기능을 제공합니다.
6. 시스템의 오류를 검사하고 복구합니다.
7. 자원 보호 기능을 제공합니다.
8. 입 출력에 대한 보조 기능을 제공합니다.
9. 가상 계산기 능력을 제공합니다.


### 프로세스
일반적으로 CPU에 의해 처리되는 사용자 프로그램, 시스템 프로그램 , 시스템 프로그램 즉 ***실행중인 프로그램*** 의미하며 작업(job),테스크(task) 라고도 한다.
- __프로그램__ 은 일반적으로 하드디스크 등에 저장되어있는 실행 코드 의미
- __프로세스__ 는 프로그램을 구동하여 프로그램 자체와 프로그램 상태가 메모리 상에서 실행되는 작업 단위를 지칭

특징
▶️ 프로세스는 각각 Code, Data, Stack, Heap의 구조로 되어있는 독립된 메모리 영역을 할당 받는다.
▶️ 각 프로세스는 별도의 주소 공간에서 실행되며, 서로 독자적인 메모리 공간을 갖기 때문에 서로 메모리 공간을 공유할 수 없다. 즉, 다른 프로세스의 변수나 자료구조에 접근할 수 없다.
▶️ 다른 프로세스의 자원에 접근하려면 프로세스간의 통신(IPC)을 사용해야한다.
▶️ 프로세스는 최소 하나 이상의 스레드를 포함한다.

### 스레드
스레드란 어떠한 프로그램 네애ㅔ서 , 특히 ***프로세스*** 내에서 실행되는 흐름의 단위


## 시분할 시스템
CPU의 정보 처리속도는 프로세스가 자원을 이용하는 속도보다 빠르다.
CPU가 더 효율적으로 사용될 수 있도록 여러작업을 번갈아가며 실행하는 방식을 도입하게 된다
우선순위를 정해 작업을 결정하는 과정을 CPU 스케줄링
**시분할 시스템** 이란 여러 명의 사용자가 사용하는 시스템에서 컴퓨터가 사용자들의 프로그램을 번갈아가며 처리해줌으로써 각 사용자에게 독립된 컴퓨터를 사용하는 느낌을 주는 것으로, 라운드 로빈(Round Robin)방식이라고도 합니다.

여러 사용자가 각자의 단말장치를 통하여 동시에 운영체제와 대화하면서 각자의 프로그램을 실행합니다.
하나의 CPU는 같은 시점에서 여러 개의 작업을 동시에 수행할 수 없기 때문에, CPU의 전체 사용시간을 작은 작업 시간량으로 쪼개어 그 시간량 동안만 번갈아가면서 CPU를 할당하여 각 작업을 처리합니다.
다중프로그래밍 방식과 결합하여 모든 작업이 동시에 진행되는 것처럼 대화식 처리가 가능합니다.
시스템의 전체 효율은 좋아지나 개인별 사용자 입장에서는 반응 속도가 느려질 수 있습니다.
각 작업에 대한 응답 시간을 최소한으로 줄이는 것을 목적으로 하며, 하드웨어를 보다 능률적으로 사용할 수 있습니다.

## 다중 프로그래밍 시스템
여러 개의 프로그램을 메모리에 적재하여 실행하는데 하나를 실행하다 대기 상태가 되면 다른 프로그램을 실행한다.
하나의 프로그램을 실행하다가 입출력과 관련된 작업이 실행되면 대기 상태가 되고 이 때 다른 프로그램을 실행하는 것이다.
일괄 처리 시스템과 달리 입출력 장치가 일을 하는 동안 cpu가 쉬는 것이 아니라 다른 프로그램에 대해서 일을 계속 하기 때문에 cpu 사용 효율이 증가한다.
이 시스템에서 운영체제는 작업스케줄링과 cpu스케줄링을 진행  
- 작업 스케줄링 : 디스크의 작업 저장소에서 적절한 작업을 메모리로 옮긴다.
- cpu 스케줄링 : 현재 실행중인 작업이 대기 상태에 들어가면 적절한 작업을 메모리에서 선택해서 cpu에게 전달한다.


## 대화형 시스템(Interactive system)

다중 작업용 운영 체제의 경우 여러 프로그램들을 같이 수행시켜도 사용자 입장에서는 각 프로그램에 대한 키보드 입력의 결과를 곧바로 화면에 보여 주기 때문에 이러한 시스템을 대화형 시스템이라고도 부른다.

## 다중 처리기의 개요
다중 처리기(Multi-Processor)는 하나의 시스템에 여러 개의 처리기(프로세서)를 두어 하나의 작업을 각 처리기에게 할당하여 수행하도록 하는 것을 의미한다.
- 다중 처리기는 프로세서간 상호작용이 밀접한 강결합 시스템이다.  
- 여러 작업을 동시에 처리하여 실행 시간이 감소되고 전체 효율을 향상시킬 수 있다.  
- 하나의 복합적인 운영체제에 의하여 전체 시스템이 제어된다.  
- 여러 프로세서는 하나의 공통된 기억장소를 가진다.  
- 프로세서들 중 하나가 고장 나도 다른 프로세서들에 의해 작업이 처리되므로 장애극복이 가능하다.  
- 각 프로세서는 자체 계산 능력을 가지고 있으며, 프로세서나 주변장치 등을 공동 사용한다. 
- 다중 처리기는 공유-기억장치 시스템과 분선-기억장치 시스템으로 구분된다.  

# 커널이란?

컴퓨터와 전원을 켜면 운영체제는 이와 동시에 수행된다. 한편 소프트웨어가 컴퓨터 시스템에서 수행되기 위해서는 메모리에 그 프로그램이 올라가 있어야 한다. 마찬가지로 운영체제 자체도 소프트웨어로서 전원이 켜짐과 동시에 메모리에 올라가야 한다. 하지만, 운영체제처럼 규모가 큰 프로그램이 모두 메모리에 올라간다면 한정된 메모리 공간의 낭비가 심할것이다. 따라서 운영체제 중 항상 필요한 부분만을 전원이 켜짐과 동시에 메모리에 올려놓고 그렇지 않은 부분은 필요할 때 메모리에 올려서 사용하게 된다. 이 때 메모리에 상주하는 운영체제의 부분을 커널이라 한다. 또 이것을 좁은 의미의 운영체제라고도 한다. 즉 커널은 메모리에 상주하는 부분으로써 운영체제의 핵심적인 부분을 뜻한다. 이에 반에 넓은 의미의 운영체제는 커널뿐 아니라 각종 시스템을 위한 유틸리티들을 광범위하게 포함하는 개념이다. (보통은 운영체제라고 하면 커널을 말하게 된다.)

역할 
  
인터페이스를 제공하는 역할을 하며 컴퓨터 자원들을 관리하는 역할을 한다. 즉, 커널은 인터페이스로써 응용 프로그램 수행에 필요한 여러가지 서비스를 제공하고, 여러가지 하드웨어(CPU, 메모리) 등의 리소스를 관리하는 역할을 한다.
  
- 커널을 컴퓨터 자원들을 바라만 보고 있기때문에 사용자와 직접적인 상호작용x 대신 쉘이라는 프로그램으로 상호작용함  
- 커널의 가장 큰 목표는 컴퓨터의 물리적(하드웨어) 자원과 추상화 자원을 관리하는거
-  추상화란 물리적으로 하나뿐인 하드웨어를 여러 사용자들이 번갈아 사용할 수 있도록 마치 여러개처럼 보이게 하는 기술이다. 즉, 커널이 관리함에 따라 각 사용자들을 하나의 하드웨어를 독점하는 것처럼 느낄 수 있도록 한다. 커널이 추상화하여 관리하는 물리적 자원들과 이를 추상화한 자원을 칭하는 용어로는
-  대표적으로 CPU - Task or Process, 메모리 - Page or Segment, 디스크 - File, 네트워크 - Socket 등이 있다.
-  Task(Process) Management : 물리적 자원인 CPU를 추상적 자원인 Task로 제공
Memory Management : 물리적 자원인 메모리를 추상적 자원인 Page 또는 Segement로 제공
File System : 물리적 자원인 디스크를 추상적 자원인 File로 제공
Network Managment : 물리적 자원인 네트워크 장치를 추상적 자원인 Socket으로 제공
Device Driver Management : 각종 외부 장치에 대한 접근
Interrupt Handling : 인터럽트 핸들러
I/O Communication : 입출력 통신 관리


## 유저모드와 커널모드
커널에서 중요한 자원을 관리하기 때문에, 사용자가 그 중요한 자원에 접근하지 못하도록 모드를 2가지로 나눈 것입니다.  

### 유저모드 
 유저(사용자)가 접근할 수 있는 영역을 제한적으로 두고, 프로그램의 자원에 함부로 침범하지 못하는 모드 입니다.
: 우리는 여기서 코드를 작성하고, 프로세스를 실행하는 등의 행동을 할 수 있습니다.
: 간단하게 유저 어플리케이션 코드가 유저모드에서 실행된다. 라고 말할 수 있습니다

### 커널모드
: 모든 자원(드라이버, 메모리, CPU 등)에 접근, 명령을 할 수 있습니다. 
: 유저모드와는 비교가 안되게 컴퓨터 내부에서 모든 짓? 을 할 수 있다고 생각하면 되겠습니다
프로세스가 실행되는 동안에 프로세스는 수없이 유저모드와 커널모드를 왔다갔다 하면서 실행이 됩니다.

(유저모드 -> 커널모드 요청)
프로세스가 유저모드에서 실행되다가 특별한 요청이 필요할때 system call을 이용해서 커널에 요청을 합니다. 

(커널모드 -> 유저모드로 반환)
system call의 요청을 받은 커널이 그 요청에 대한 일을 하고 결과값을 system call의 리턴 값으로 전해줍니다.

예를 들어 프로세스가 실행되고있는 중에 라이브러리 함수인 fopen함수를 호출했다고 가정해보겠습니다.
그렇게되면 fopen 내부에서 system call인 open을 호출하면서 커널모드로 넘어갑니다.
open에 대한 입력값이 커널로 전달이 되고 해당 일을 완료하고 커널에서 return을 해주면서 유저모드로 돌아가게됩니다.

#시스템콜
커널에 접근하기 위한 인터페이스
응용프로그램은 OS가 제공하는 인터페이스를 통해서만 자원을 사용 가능, OS가 제공하는 이러한 인터페이스를 시스템 콜이라 함.
시스템 호출(system call)은 운영 체제의 커널이 제공하는 서비스에 대해, 응용 프로그램의 요청에 따라 커널에 접근하기 위한 인터페이스이다. 

필요한 이유
-  우리가 일반적으로 사용하는 프로그램은 '응용프로그램'입니다. 유저레벨의 프로그램은 유저레벨의 함수들 만으로는 많은 기능을 구현하기 힘들기 때문에, 커널(kernel)의 도움을 반드시 받아야 합니다. 이러한 작업은 응용프로그램으로 대표되는 유저 프로세스(User Process)에서 유저모드에서는 수행할 수 없습니다. 반드시 kernel에 관련된 것은 커널모드로 전환한 후에야, 해당 작업을 수행할 권한이 생깁니다. 커널 모드를 통한 이러한 작업은 반드시 시스템 콜을 통해 수행하도록 설계되어 있습니다.

시스템콜 종류
1. 프로세스 제어
2. 파일조작
3. 장치관리
4. 정보유지
5. 통신
6. 보호

# 동기식 I/O
동기식 입출력(syncronous I/O)
어떤 프로그램이 입출력을 요청했을 때 입출력 작업이 완료된 후에 그 프로그램이 후속 작업을 수행할 수 있는 방식이다. 주로 읽기 작업에 사용된다. 일반적으로 디스크, 키보드와 같은 I/O 하드웨어들이 속도가 느리므로 CPU는 입출력 작업을 기다려야 한다. I/O요청을 수행하는 동안 CPU는 별다른 일을 하지 않는 것이다. 따라서 일반적으로 입출력 수행 중에 CPU를 다른 프로그램에 할당해 CPU가 계속 쉬지 않고 일을 할 수 있도록 관리한다. 이 관리를 위해 운영체제는 프로그램을 몇 가지 상태로 나누어 관리한다. 입출력이 완료될 때 까지 CPU가 명령을 수행하지 못하는 프로그램을 봉쇄상태(blocked state)로 전환하고, 봉쇄상태의 프로그램에는 CPU를 할당하지 않는다.

이렇게 CPU를 다른 프로그램에 할당하여 CPU를 쉬지 않게 할 때 동기성(synchronization)에 문제가 생길 수 있다. 예를 들어, 프로그램 A가 원래 1이었던 파일의 내용을 3으로 수정하는 I/O요청을 하고 이를 수행하는 동안 프로그램 B에게 CPU를 할당했다고 하자. 이때 공교롭게도 프로그램 B도 A가 접근한 파일과 똑같은 곳에 접근하여 파일의 내용을 +1 하는 요청을 했다. 그러면 입출력 컨트롤러는 A와 B의 요청을 순서를 바꾸어 처리할 수도 있다. 이렇게 되면 1→3→4로 변해야하는 출력이 1→2→3으로 바뀌는 문제가 생긴다. 이런 경우를 막기 위해 하드웨어에서는 요청들을 큐(queue)에 넣어 관리한다. 디스크 차원에서는 큐에 있는 요청을 순서대로 처리함으로써 동기화 문제를 해결할 수 있다.


# 비동기식 입출력(asyncronous I/O)
입출력 연산을 요청한 후에 CPU 제어권을 입출력 연산을 호출한 해당 프로그램에  곧바로 부여하는 것은 비동기식 입출력이라고 한다. 읽기 요청이라면 비동기식 입출력이라고 하더라도 모든 데이터를 다 받아야 프로세스가 진행될 수 있을 것이므로, 읽어오는 데이터가 필요하지 않은 작업을 먼저 수행하고 입출력이 완료된 후 입력이 필요한 작업을 수행한다. 쓰기 요청이라면 데이터를 쓰는 동안 곧바로 다음 작업을 진행해도 될 것이므로 주로 쓰기 작업에 사용된다.
(입력의 경우 동기식과 다를 것이 없는 것 같은데.. 다르게 분류하여 사용하는 것인지 의문이다.)

비동기의 성능 이점 => 요청한 작업에 대하여 완료여부를 신경쓰지않고 그 다음 작업르 수행하므로, I/O 작업과 같은 느린 작업이 발생할 때, 기다리지 않고 다른 작업을 처리하면서 동시에 처리하여 멀티 작업을 진행할수 있기 때문이다. 이는 전반적인 시스템 성능 향상에 도움을 줄 수 있다.

### 참고
https://sy-note-0.tistory.com/28
[https://snoop-study.tistory.com/85
](https://structuring.tistory.com/118)https://blockdmask.tistory.com/69
https://kjhoon0330.tistory.com/entry/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9COS-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80
https://velog.io/@tlatjdgh3778/CS-%EC%A0%95%EB%A6%AC-%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C1
https://velog.io/@gparkkii/ProgramProcessThread
